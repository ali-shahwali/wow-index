@page "/refreshProfile/{region}"
@using System.Net

@code {
    [Parameter]
    public string region { get; set; }

    protected override async Task OnInitializedAsync()
    {
        string clientId = Configuration["APIClientID"];
        string str = NavigationManager.Uri.Split('/')[3];
        if (str.Equals("refreshProfile"))
        {
            // build request
            var client = new HttpClient();
            client.BaseAddress = new Uri($"https://{region}.battle.net/oauth/authorize");
            string responseType = "code";
            string redirectURI = $"{WebUtility.UrlEncode(NavigationManager.BaseUri)}authorize%2F{region}";
            string scope = "wow.profile";

            // send request
            var auth = await client.GetAsync($"?response_type={responseType}&client_id={clientId}&redirect_uri={redirectURI}&scope={scope}");

            // navigate to ruturn url
            NavigationManager.NavigateTo(auth.RequestMessage.RequestUri.OriginalString);
        }
    }
}
